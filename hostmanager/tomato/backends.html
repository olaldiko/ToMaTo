
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Backend management &#8212; ToMaTo 3 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Integrated Fileserver" href="fileserver.html" />
    <link rel="prev" title="Hostmanager API" href="api/index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fileserver.html" title="Integrated Fileserver"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="api/index.html" title="Hostmanager API"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">ToMaTo 3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Hostmanager Documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="backend-management">
<h1>Backend management<a class="headerlink" href="#backend-management" title="Permalink to this headline">¶</a></h1>
<p>The hostmanager allows different backends to use it.</p>
<div class="section" id="component-separation">
<h2>Component separation<a class="headerlink" href="#component-separation" title="Permalink to this headline">¶</a></h2>
<p>All components (i.e. elements and connections) of different backends are
separated by the hostmanager. Each component will have an owner attribute,
that references the backend that created it. The component will only be
visible and accessible by that backend.</p>
</div>
<div class="section" id="resource-separation">
<h2>Resource separation<a class="headerlink" href="#resource-separation" title="Permalink to this headline">¶</a></h2>
<p>All resources (i.e. networks and templates) of different backends are
separated by the hostmanager. Each resource will have an owner attribute,
that references the backend that created it. The resource will only be
visible and accessible by that backend.</p>
</div>
<div class="section" id="access-control">
<h2>Access control<a class="headerlink" href="#access-control" title="Permalink to this headline">¶</a></h2>
<p>The authentication of backends uses SSL keys. Each backend has a key of its own
and uses it to authenticate and encrypt connections to hostmanagers.
On the side of the hostmanager all backend keys must be present as files in
<em>PEM format</em> in a specific directory (<code class="docutils literal notranslate"><span class="pre">/etc/tomato/client_certs</span></code> in default
config).</p>
<div class="section" id="indexing-the-backend-keys">
<h3>Indexing the backend keys<a class="headerlink" href="#indexing-the-backend-keys" title="Permalink to this headline">¶</a></h3>
<p>After modifying the SSL keys, the certificate index must be rebuilt.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">update</span><span class="o">-</span><span class="n">tomato</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">certs</span>
</pre></div>
</div>
<p>Note that the hostmanager does not have to be restarted after rebuilding the
index.
Also note that the hostmanager will issue the command to rebuild the
certificate index automatically when it is starting.</p>
</div>
<div class="section" id="backend-identification">
<h3>Backend identification<a class="headerlink" href="#backend-identification" title="Permalink to this headline">¶</a></h3>
<p>The identity of a backend is based on the <em>common name (CN)</em> in its
certificate. Different certificates with the same common name field will be
treated as the same backend and share access to components.</p>
</div>
<div class="section" id="generating-a-key-pair">
<h3>Generating a key-pair<a class="headerlink" href="#generating-a-key-pair" title="Permalink to this headline">¶</a></h3>
<p>A self-signed key-pair can be created with the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">openssl</span> <span class="n">req</span> <span class="o">-</span><span class="n">new</span> <span class="o">-</span><span class="n">x509</span> <span class="o">-</span><span class="n">days</span> <span class="mi">1000</span> <span class="o">-</span><span class="n">nodes</span> <span class="o">-</span><span class="n">out</span> <span class="n">key</span><span class="o">.</span><span class="n">pem</span> <span class="o">-</span><span class="n">keyout</span> <span class="n">cert</span><span class="o">.</span><span class="n">pem</span>
</pre></div>
</div>
<p>It is important to create a key without a password if the the key should be
used for a backend.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Backend management</a><ul>
<li><a class="reference internal" href="#component-separation">Component separation</a></li>
<li><a class="reference internal" href="#resource-separation">Resource separation</a></li>
<li><a class="reference internal" href="#access-control">Access control</a><ul>
<li><a class="reference internal" href="#indexing-the-backend-keys">Indexing the backend keys</a></li>
<li><a class="reference internal" href="#backend-identification">Backend identification</a></li>
<li><a class="reference internal" href="#generating-a-key-pair">Generating a key-pair</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="api/index.html"
                        title="previous chapter">Hostmanager API</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="fileserver.html"
                        title="next chapter">Integrated Fileserver</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/hostmanager/tomato/backends.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fileserver.html" title="Integrated Fileserver"
             >next</a> |</li>
        <li class="right" >
          <a href="api/index.html" title="Hostmanager API"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">ToMaTo 3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Hostmanager Documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012, Dennis Schwerdel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>